@model ProjectPortfolio.Models.Project

@{
    ViewBag.Title = "Rediger";
}

<h2>Rediger</h2>


@using (Html.BeginForm("Edit", "Project", null, FormMethod.Post, new { enctype = "multipart/form-data" }))
{
                @Html.AntiForgeryToken()

      <div class="form-horizontal">
        <h4>@Model.Name</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.ProjectId)

          <h4 class="divider">Overordnet projektinformation</h4>
          <hr class="divider" />
          <div class="form-group">
            @Html.LabelFor(model => model.Status, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EnumDropDownListFor(model => model.Status, 
               htmlAttributes: new { @class = "form-control", id="status", onchange = "accepted(this)" })
                @Html.ValidationMessageFor(model => model.Status, "", new { @class = "text-danger" })
            </div>
        </div>
        
        <div class="form-group">
            @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.StartDate, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.StartDate, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.StartDate, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.EndDate, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.EndDate, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.EndDate, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Description, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Description, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
            </div>
        </div>
          <br />
          <h4 class="divider">Økonomi</h4>
          <hr class="divider" />
        <div class="form-group">
            @Html.LabelFor(model => model.Budget, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Budget, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Budget, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.SelfFinancing, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.SelfFinancing, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.SelfFinancing, "", new { @class = "text-danger" })
            </div>
        </div>
        
          <div class="form-group">
              @Html.LabelFor(model => model.MultiplePartners, htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.EnumDropDownListFor(model => model.MultiplePartners, new { @class = "form-control", onchange = "multiplep(this)" })
                  @Html.ValidationMessageFor(model => model.MultiplePartners, "", new { @class = "text-danger" })
              </div>
          </div>

          <div class="form-group skjulMultiple">
              @Html.LabelFor(model => model.Owner, htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.EnumDropDownListFor(model => model.Owner, new { @class = "form-control" })
                  @Html.ValidationMessageFor(model => model.Owner, "", new { @class = "text-danger" })
              </div>
          </div>
          
          <div class="form-group skjulMultiple">
            @Html.LabelFor(model => model.AggregatedBudget, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.AggregatedBudget, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.AggregatedBudget, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.FunderId, "Bevillingstype", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("FunderId", null, string.Empty, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.FunderId, "", new { @class = "text-danger" })
            </div>
        </div>
          
          <br />
          <h4 class="divider">Strategisk</h4>
          <hr class="divider" />

        <div class="form-group">
            @Html.LabelFor(model => model.ProgramId, "Program", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("ProgramId", null, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.ProgramId, "", new { @class = "text-danger" })
            </div>
        </div>

          <div class="form-group">
              @Html.LabelFor(model => model.PrimaryFocus, "Primært indsatsområde", htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.DropDownList("PrimaryFocus", null, string.Empty, htmlAttributes: new { @class = "form-control" })
                  @Html.ValidationMessageFor(model => model.PrimaryFocus, "", new { @class = "text-danger" })
              </div>
          </div>

          <div class="form-group">
              @Html.LabelFor(model => model.SecondaryFocus, "Underindsatsområde", htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.DropDownList("SecondaryFocus", null, string.Empty, htmlAttributes: new { @class = "form-control" })
                  @Html.ValidationMessageFor(model => model.SecondaryFocus, "", new { @class = "text-danger" })
              </div>
          </div>

          <br />
          <h4 class="divider">Ansvar</h4>
          <hr class="divider" />

          <div class="form-group">
              @Html.LabelFor(model => model.Person, htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.EditorFor(model => model.Person, new { htmlAttributes = new { @class = "form-control" } })
                  @Html.ValidationMessageFor(model => model.Person, "", new { @class = "text-danger" })
              </div>
          </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Responsible, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Responsible, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Responsible, "", new { @class = "text-danger" })
            </div>
        </div>

          <div class="form-group">
              @Html.LabelFor(model => model.RespNo, htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.EditorFor(model => model.RespNo, new { htmlAttributes = new { @class = "form-control" } })
                  @Html.ValidationMessageFor(model => model.RespNo, "", new { @class = "text-danger" })
              </div>
          </div>


          <br />
          <h4 class="divider">Øvrigt</h4>
          <hr class="divider" />

        @* Start attachment - application *@

        @if (Model.Files.Any(f => f.FileType == FileType.application))
        {
            <div class="form-group">
                <span class="control-label col-md-2"><strong>Ansøgning</strong></span>
                <div class="col-md-10">
                    @Html.ActionLink(@Model.Files.First(f => f.FileType == FileType.application).FileName, "Index", "File",
                new { id = @Model.Files.First(f => f.FileType == FileType.application).FileId }, null)  |
                      @Html.ActionLink("Slet", "Delete", "File",
                new { id = @Model.Files.First(f => f.FileType == FileType.application).FileId, p_id = Model.ProjectId }, null)
                </div>
            </div>
        }

        <div class="form-group">
            @Html.Label("Tilføj/erstat ansøgning", new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input type="file" id="Application" name="uploadApp" class="btn btn-default"/>
            </div>
        </div>

                    @* End attachment *@
    

        @* Start attachment - response *@

        @if (Model.Files.Any(f => f.FileType == FileType.response))
        {
            <div class="form-group">
                <span class="control-label col-md-2"><strong>Svar fra fond</strong></span>
                <div class="col-md-10">
                    @Html.ActionLink(@Model.Files.First(f => f.FileType == FileType.response).FileName, "Index", "File",
                new { id = @Model.Files.First(f => f.FileType == FileType.response).FileId }, null)  |
                      @Html.ActionLink("Slet", "Delete", "File",
                new { id = @Model.Files.First(f => f.FileType == FileType.response).FileId, p_id = Model.ProjectId }, null)
                </div>
                
            </div>
        }

        <div class="form-group">
            @Html.Label("Tilføj/erstat svarbrev", new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input type="file" id="Response" name="uploadResponse" class="btn btn-default" />
            </div>
             
        </div>

        @* End attachment *@

          
          

          
          <div class="form-group"  title="Projektnummer oprettes af Budget- og aktivitetsstyring" >
              @Html.LabelFor(model => model.ProjectNumber, htmlAttributes: new { @class = "control-label col-md-2" })
              
              <div class="col-md-10">
                  @Html.EditorFor(model => model.ProjectNumber, new { htmlAttributes = new { @class = "form-control" } })
                  @Html.ValidationMessageFor(model => model.ProjectNumber, "", new { @class = "text-danger" })
              </div>
          </div>

          
          <div class="form-group skjulStatus" style="display:none">
              @Html.LabelFor(model => model.ExtProjectNumber, htmlAttributes: new { @class = "control-label col-md-2" })

              <div class="col-md-10">
                  @Html.EditorFor(model => model.ExtProjectNumber, new { htmlAttributes = new { @class = "form-control" } })
                  @Html.ValidationMessageFor(model => model.ExtProjectNumber, "", new { @class = "text-danger" })
              </div>
          </div>

          <div class="form-group">
              @Html.LabelFor(model => model.Remark, htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.EditorFor(model => model.Remark, new { htmlAttributes = new { @class = "form-control" } })
                  @Html.ValidationMessageFor(model => model.Remark, "", new { @class = "text-danger" })
              </div>
          </div>

          <div class="form-group">
              @Html.LabelFor(model => model.ProjectLink, htmlAttributes: new { @class = "control-label col-md-2" })
              <div class="col-md-10">
                  @Html.EditorFor(model => model.ProjectLink, new { htmlAttributes = new { @class = "form-control" } })
                  @Html.ValidationMessageFor(model => model.ProjectLink, "", new { @class = "text-danger" })
              </div>
          </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Gem" class="btn btn-default" />
            </div>
        </div>


    </div>
}

<div>
    @Html.ActionLink("Tilbage til listen", "Index")
</div>

<script>
    var multiple = document.getElementsByClassName("skjulMultiple");

    if ("@Model.Status.ToString()" == "Bevilget_IS"
        || "@Model.Status.ToString()" == "Bevilget_S"
        || "@Model.Status.ToString()" == "Afslag"
        || "@Model.Status.ToString()" == "Afbrudt") {
        document.getElementsByClassName("skjulStatus")[0].style.display = "block";
        document.getElementsByClassName("skjulStatus")[1].style.display = "block";
    }
    if ("@Model.MultiplePartners.ToString()" == "Nej"
        || "@Model.MultiplePartners.ToString()" == null) {

        for (var i = 0; i < multiple.length; i++) {
            multiple[i].style.display = "none";
        }
    }


    function accepted(option) {

        console.log(option.value);

        if (option.value > 1) {
            if (option.value == 2 || option.value == 3) {
                alert("Husk at give Budgetafdelingen besked, hvis din projektansøgning er godkendt, " +
                "så du kan få et projektnummer.");
            }
            document.getElementsByClassName("skjulStatus")[0].style.display = "block";
            document.getElementsByClassName("skjulStatus")[1].style.display = "block";
        }

    }

    function multiplep(option) {

        console.log("Multiple called: " + option.value);

        if (option.value == 1) {
            for (var i = 0; i < multiple.length; i++) {
                multiple[i].style.display = "block";
            }
        }
        else {
            for (var i = 0; i < multiple.length; i++) {
                multiple[i].style.display = "none";
            }
        }
    }


</script>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
